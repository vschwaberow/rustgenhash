{
  "id": "digest_file_sha1_warning",
  "mode": "digest_file",
  "algorithm": "SHA1",
  "input": {
    "path": "tests/fixtures/file/sample.txt"
  },
  "expected_output": {
    "format": "hex",
    "default_lines": [
      "0e73db2191b802e1dd8443669e0e03c075dbd8e9 tests/fixtures/file/sample.txt"
    ],
    "hash_only_lines": [
      "0e73db2191b802e1dd8443669e0e03c075dbd8e9"
    ],
    "entries": [
      {
        "path": "tests/fixtures/file/sample.txt",
        "digest": "0e73db2191b802e1dd8443669e0e03c075dbd8e9"
      }
    ],
    "exit_code": 0,
    "failure_count": 0,
    "should_write_manifest": true,
    "fatal_error": null,
    "warning_banner": "⚠ WARNING: SHA-1 is a weak algorithm (collisions known) See NIST SP 800-131A rev.2 §3 and BSI TR-02102-1 recommendations. Use SHA-256 or SHA-512.",
    "warning_references": [
      "https://doi.org/10.6028/NIST.SP.800-131Ar2",
      "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TG02102/BSI-TR-02102-1.pdf"
    ]
  },
  "metadata": {
    "severity": "high",
    "notes": "Ensures digest file mode records the weak-algorithm warning while preserving manifest output.",
    "skip_reason": null
  }
}
